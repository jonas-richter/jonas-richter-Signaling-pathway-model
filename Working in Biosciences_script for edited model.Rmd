---
title: "Working in Biosciences"
author: "Jonas Richter"
date: "11/15/2021"
output: html_document
---
# Wnt model
  
To load this script successfully, download the models established by Asim Bikas Das et al. from BioModels (https://www.ebi.ac.uk/biomodels/search?query=Rahul+Rao+Padala&domain=biomodels) and store this Rmd file in the same folder.
  
Load packages
```{r, include = FALSE}
#install.packages("remotes")
#remotes::install_github("jpahle/CoRC")
library(CoRC)
library(ggplot2)
library(dplyr)
library(magrittr)
library(egg)

# Set standard theme for ggplots
theme_set(theme_bw(base_size = 15))
```
Load "normal" model
```{r, include=FALSE}
# Load
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
```

## Recapitulate Figure 2 plots (normal)  
Fig 2A
```{r}
# Set timecourse
timecourse_2A <- c()
timecourse_2A$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_2A$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_2A$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_2A$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# retrieve results from different timecourse settings
results_timecourse2A <- lapply(timecourse_2A, function(x) as.data.frame(x$result))

# Fig 2A
Fig2_A <- mapply(function(x) ggplot(x, aes(x=Time, y=pERK))+ geom_line(), results_timecourse2A, USE.NAMES = T, SIMPLIFY = F)

Fig2_A_Grob <- arrangeGrob(grobs = Fig2_A)
ggsave(filename = "Fig2A.png", plot = Fig2_A_Grob)

ggsave(filename = "2A_factor10.png", plot = Fig2_A[["duration_factor10"]])
```
  

Fig. 2B
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# Set timecourse
timecourse_2B <- c()
timecourse_2B$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_2B$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_2B$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_2B$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# retrieve results from different timecourse settings
results_timecourse2B <- lapply(timecourse_2B, function(x) as.data.frame(x$result))

# Plot
Fig2_B <- mapply(function(x) ggplot(x, aes(Time, pAkt))+ geom_line(), results_timecourse2B, USE.NAMES = T, SIMPLIFY = F)

Fig2_B_Grob <- arrangeGrob(grobs = Fig2_B)
ggsave(filename = "Fig2B.png", plot = Fig2_B_Grob)

ggsave(filename = "2B_factor10.png", plot = Fig2_B[["duration_factor10"]])
```
  
Fig. 2C
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# Set time course (initial value of Wnt (W) is 0 by default)
timecourse_2C <- c()
timecourse_2C$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_2C$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_2C$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_2C$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse2C <- lapply(timecourse_2C, function(x) as.data.frame(x$result))


# Set initial concentration of Wnt (W) = 100
setSpecies("W", initial_concentration = 100)
# Save normal model with initial Wnt concentration = 1
saveModel(filename = "normal_model_W1_JR.xml",overwrite = TRUE, model = normal_model)
# Set timecourse
timecourse_2C_W1 <- c()
timecourse_2C_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_2C_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_2C_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_2C_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse2C_W1 <- lapply(timecourse_2C_W1, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, bCatenin_TCF))+geom_line(aes(col='0'))+
    geom_line(data=y, aes(Time, bCatenin_TCF, col='1'))+ 
    scale_color_manual(name='Initial Wnt value',
                       breaks=c('0','1'),
                       values=c('0'='red', '1'='blue'))
}

Fig2_C <- mapply(funct, results_timecourse2C, results_timecourse2C_W1, USE.NAMES = T, SIMPLIFY = F)

Fig2_C_Grob <- arrangeGrob(grobs = Fig2_C)
ggsave(filename = "Fig2C.png", plot = Fig2_C_Grob)

ggsave(filename = "2C_factor100.png", plot = Fig2_C[["duration_factor100"]])
```

## Recapitulate Figure 3 plots (Ras mutated (A-C)/B-Raf mutated (D-F))  
Fig. 3A
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# Set time course
timecourse_3A <- c()
timecourse_3A$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3A$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3A$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3A$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3A <- lapply(timecourse_3A, function(x) as.data.frame(x$result))

# Remove Ras deactivation reaction from normal_model
deleteReaction(key = "Ras dephosphorylation (Ras_Gap modifier)", model = normal_model)
# Save Ras mutated model
saveModel(filename = "Ras_mutated_JR.xml",overwrite = TRUE, model = normal_model)
# Set time course
timecourse_3A_Ras <- c()
timecourse_3A_Ras$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3A_Ras$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3A_Ras$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3A_Ras$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3A_Ras <- lapply(timecourse_3A_Ras, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, pRaf1))+geom_line(aes(col='normal'))+ 
    geom_line(data=y, aes(Time, pRaf1, col='mutated'))+ 
    scale_color_manual(name='Ras genotype',
                       breaks=c('normal','mutated'),
                       values=c('normal'='black', 'mutated'='red'))
}

Fig3_A <- mapply(funct, results_timecourse3A, results_timecourse3A_Ras, USE.NAMES = T, SIMPLIFY = F)

Fig3_A_Grob <- arrangeGrob(grobs = Fig3_A)
ggsave(filename = "Fig3A.png", plot = Fig3_A_Grob)

ggsave(filename = "3A_factor100.png", plot = Fig3_A[["duration_factor100"]])
```
  
Fig. 3B
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
Ras1_model <- loadModel('Ras_mutated_JR.xml')

# Set time course
timecourse_3B <- c()
timecourse_3B$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3B$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3B$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3B$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3B <- lapply(timecourse_3B, function(x) as.data.frame(x$result))

# Remove Ras deactivation reaction from normal_model
deleteReaction(key = "Ras dephosphorylation (Ras_Gap modifier)", model = normal_model)
# Save Ras mutated model
saveModel(filename = "Ras_mutated_JR.xml",overwrite = TRUE, model = normal_model)
# Set time course
timecourse_3B_Ras <- c()
timecourse_3B_Ras$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3B_Ras$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3B_Ras$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3B_Ras$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3B_Ras <- lapply(timecourse_3B_Ras, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, pRaf1))+geom_line(aes(col='normal'))+ 
    geom_line(data=y, aes(Time, pRaf1, col='mutated'))+ 
    scale_color_manual(name='pERK genotype',
                       breaks=c('normal','mutated'),
                       values=c('normal'='black', 'mutated'='red'))
}

Fig3_B <- mapply(funct, results_timecourse3B, results_timecourse3B_Ras, USE.NAMES = T, SIMPLIFY = F)

Fig3_B_Grob <- arrangeGrob(grobs = Fig3_B)
ggsave(filename = "Fig3B.png", plot = Fig3_B_Grob)

ggsave(filename = "3B_factor100.png", plot = Fig3_B[["duration_factor100"]])
```
  
Fig. 3C
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
Ras1_model <- loadModel('Ras_mutated_JR.xml')
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')

# Set time course
timecourse_3C <- c()
timecourse_3C$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3C$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3C$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3C$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3C <- lapply(timecourse_3C, function(x) as.data.frame(x$result))

# Set time course
timecourse_3C_W1 <- c()
timecourse_3C_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_3C_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_3C_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_3C_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)
# retrieve results from different timecourse settings
results_timecourse3C_W1 <- lapply(timecourse_3C_W1, function(x) as.data.frame(x$result))

# Set time course
timecourse_3C_Ras <- c()
timecourse_3C_Ras$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = Ras1_model)
timecourse_3C_Ras$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = Ras1_model)
timecourse_3C_Ras$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = Ras1_model)
timecourse_3C_Ras$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = Ras1_model)
# retrieve results from different timecourse settings
results_timecourse3C_Ras <- lapply(timecourse_3C_Ras, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z){
  ggplot(data=x, aes(Time, bCatenin_TCF))+geom_line(aes(col='mutated (W=0)'))+ 
    geom_line(data=y, aes(Time, bCatenin_TCF, col='normal (W=0)'))+ 
    geom_line(data=z, aes(Time, bCatenin_TCF, col='normal (W=1)'))+
    scale_color_manual(name='Ras genotype',
                       breaks=c('normal (W=0)', 'mutated (W=0)', 'normal (W=1)'),
                       values=c('mutated (W=0)'='red', 'normal (W=0)'='black', 'normal (W=1)'='blue'))
}

Fig3_C <- mapply(funct, results_timecourse3C_Ras, results_timecourse3C, results_timecourse3C_W1, USE.NAMES = T, SIMPLIFY = F)


Fig3_C_Grob <- arrangeGrob(grobs = Fig3_C)
ggsave(filename = "Fig3C.png", plot = Fig3_C_Grob)

ggsave(filename = "3C_factor100.png", plot = Fig3_C[["duration_factor100"]])
```
  
Fig. 3D
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# Set time course
timecourse_3D <- c()
timecourse_3D$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3D$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3D$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3D$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3D <- lapply(timecourse_3D, function(x) as.data.frame(x$result))

# Remove bRaf dephosphorylation reaction from normal_model
deleteReaction(key = c("bRaf dephosphorylation (RafPPtase modifier)", "bRaf dephosphorylation (pAkt modifier)"), model = normal_model)
# Save bRaf mutated model
saveModel(filename = "bRaf_mutated_JR.xml",overwrite = TRUE, model = normal_model)
# Set time course
timecourse_3D_bRaf <- c()
timecourse_3D_bRaf$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3D_bRaf$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3D_bRaf$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3D_bRaf$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3D_bRaf <- lapply(timecourse_3D_bRaf, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, pMEK))+geom_line(aes(col='normal'))+ 
    geom_line(data=y, aes(Time, pMEK, col='mutated'))+ 
    scale_color_manual(name='bRaf genotype',
                       breaks=c('normal','mutated'),
                       values=c('normal'='black', 'mutated'='red'))
}

Fig3_D <- mapply(funct, results_timecourse3D, results_timecourse3D_bRaf, USE.NAMES = T, SIMPLIFY = F)


Fig3_D_Grob <- arrangeGrob(grobs = Fig3_D)
ggsave(filename = "Fig3D.png", plot = Fig3_D_Grob)

ggsave(filename = "3D_factor100.png", plot = Fig3_D[["duration_factor100"]])
```
  
Fig. 3E
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
bRaf_model <- loadModel('bRaf_mutated_JR.xml')

# Set time course
timecourse_3E <- c()
timecourse_3E$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3E$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3E$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3E$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3E <- lapply(timecourse_3E, function(x) as.data.frame(x$result))

# Set time course
timecourse_3E_bRaf <- c()
timecourse_3E_bRaf$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = bRaf_model)
timecourse_3E_bRaf$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = bRaf_model)
timecourse_3E_bRaf$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = bRaf_model)
timecourse_3E_bRaf$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = bRaf_model)
# retrieve results from different timecourse settings
results_timecourse3E_bRaf <- lapply(timecourse_3E_bRaf, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, pERK))+geom_line(aes(col='normal'))+ 
    geom_line(data=y, aes(Time, pERK, col='mutated'))+ 
    scale_color_manual(name='bRaf genotype',
                       breaks=c('normal','mutated'),
                       values=c('normal'='black', 'mutated'='red'))
}

Fig3_E <- mapply(funct, results_timecourse3E, results_timecourse3E_bRaf, USE.NAMES = T, SIMPLIFY = F)


Fig3_E_Grob <- arrangeGrob(grobs = Fig3_E)
ggsave(filename = "Fig3E.png", plot = Fig3_E_Grob)

ggsave(filename = "3E_factor10.png", plot = Fig3_E[["duration_factor10"]])
```
  
Fig. 3F
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
bRaf_model <- loadModel('bRaf_mutated_JR.xml')
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')

# Set time course
timecourse_3F <- c()
timecourse_3F$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_3F$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_3F$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_3F$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
# retrieve results from different timecourse settings
results_timecourse3F <- lapply(timecourse_3F, function(x) as.data.frame(x$result))

# Set time course
timecourse_3F_W1 <- c()
timecourse_3F_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_3F_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_3F_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_3F_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)
# retrieve results from different timecourse settings
results_timecourse3F_W1 <- lapply(timecourse_3F_W1, function(x) as.data.frame(x$result))

# Set time course
timecourse_3F_bRaf <- c()
timecourse_3F_bRaf$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = bRaf_model)
timecourse_3F_bRaf$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = bRaf_model)
timecourse_3F_bRaf$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = bRaf_model)
timecourse_3F_bRaf$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = bRaf_model)
# retrieve results from different timecourse settings
results_timecourse3F_bRaf <- lapply(timecourse_3F_bRaf, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z){
  ggplot(data=x, aes(Time, bCatenin_TCF))+geom_line(aes(col='mutated (W=0)'))+ 
    geom_line(data=y, aes(Time, bCatenin_TCF, col='normal (W=0)'))+ 
    geom_line(data=z, aes(Time, bCatenin_TCF, col='normal (W=1)'))+
    scale_color_manual(name='bRaf genotype',
                       breaks=c('normal (W=0)', 'mutated (W=0)', 'normal (W=1)'),
                       values=c('mutated (W=0)'='red', 'normal (W=0)'='black', 'normal (W=1)'='blue'))
}

Fig3_F <- mapply(funct, results_timecourse3F_bRaf, results_timecourse3F, results_timecourse3F_W1, USE.NAMES = T, SIMPLIFY = F)

Fig3_F_Grob <- arrangeGrob(grobs = Fig3_F)
ggsave(filename = "Fig3F.png", plot = Fig3_F_Grob)

ggsave(filename = "3F_factor100.png", plot = Fig3_F[["duration_factor100"]])
```
  
## Recapitulate Figure 4 plots (Increased EGFR expression (A-C)/EGFR mutated (D-F))  
**I presumed that the expression of EGFR could be altered in the model via the initial concentration of freeEGFR. However, this has only a marginal effect on pERK, pAkt and TCF/ß-catenin (4A1,B1,C1). It seems like the authors changed the initial concentrations or expression of boundEGFR. However, they don't mention this in the paper and also do not discuss which values were used for initial concentration/expression. An initial concentration of 300 mol/l as set for freeEGFR leads to similar results (4A2,B2,C2) as shown in the paper. I have doubts that the initial concentration of boundEGFR resembles a change in expression**  
Fig. 4A1 (free EGFR)
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# 1 fold EGFR
setSpecies(key = "freeEGFR", compartment = "Cell", initial_concentration = 300, model = normal_model)
saveModel(filename = "1xEGFR_free.xml",overwrite = TRUE, model = normal_model)
model_1xEGFR_free <- loadModel("1xEGFR_free.xml")

# 10 fold EGFR
setSpecies(key = "freeEGFR", compartment = "Cell", initial_concentration = 3000, model = normal_model)
saveModel(filename = "10xEGFR_free.xml",overwrite = TRUE, model = normal_model)
model_10xEGFR_free <- loadModel("10xEGFR_free.xml")

# 20 fold EGFR
setSpecies(key = "freeEGFR", compartment = "Cell", initial_concentration = 6000, model = normal_model)
saveModel(filename = "20xEGFR_free.xml",overwrite = TRUE, model = normal_model)
model_20xEGFR_free <- loadModel("20xEGFR_free.xml")

# 40 fold EGFR
setSpecies(key = "freeEGFR", compartment = "Cell", initial_concentration = 12000, model = normal_model)
saveModel(filename = "40xEGFR_free.xml",overwrite = TRUE, model = normal_model)
model_40xEGFR_free <- loadModel("40xEGFR_free.xml") 

# Time course
timecourse_4A1_1xEGFR <- c()
timecourse_4A1_1xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_1xEGFR_free)
timecourse_4A1_1xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_1xEGFR_free)
timecourse_4A1_1xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_1xEGFR_free)
timecourse_4A1_1xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_1xEGFR_free)
timecourse_4A1_10xEGFR <- c()
timecourse_4A1_10xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_10xEGFR_free)
timecourse_4A1_10xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_10xEGFR_free)
timecourse_4A1_10xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_10xEGFR_free)
timecourse_4A1_10xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_10xEGFR_free)
timecourse_4A1_20xEGFR <- c()
timecourse_4A1_20xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_20xEGFR_free)
timecourse_4A1_20xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_20xEGFR_free)
timecourse_4A1_20xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_20xEGFR_free)
timecourse_4A1_20xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_20xEGFR_free)
timecourse_4A1_40xEGFR <- c()
timecourse_4A1_40xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_40xEGFR_free)
timecourse_4A1_40xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_40xEGFR_free)
timecourse_4A1_40xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_40xEGFR_free)
timecourse_4A1_40xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_40xEGFR_free)

# Results of timecourse
results_timecourse4A1_1xEGFR <- lapply(timecourse_4A1_1xEGFR, function(x) as.data.frame(x$result))
results_timecourse4A1_10xEGFR <- lapply(timecourse_4A1_10xEGFR, function(x) as.data.frame(x$result))
results_timecourse4A1_20xEGFR <- lapply(timecourse_4A1_20xEGFR, function(x) as.data.frame(x$result))
results_timecourse4A1_40xEGFR <- lapply(timecourse_4A1_40xEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z,w){
  ggplot(data=x, aes(Time, pERK))+
  geom_line(aes(col='1xEGFR'))+ 
    geom_line(data=y, aes(Time, pERK, col='10xEGFR'))+ 
    geom_line(data=z, aes(Time, pERK, col='20xEGFR'))+
    geom_line(data=w, aes(Time, pERK, col='40xEGFR'))+
  scale_color_manual(name='Fold change in free EGFR',
                     breaks=c('1xEGFR', '10xEGFR', '20xEGFR', '40xEGFR'),
                     values=c('1xEGFR'='black', '10xEGFR'='green', '20xEGFR'='red', '40xEGFR' = 'brown'))
}

Fig4_A1 <- mapply(funct, 
                  results_timecourse4A1_1xEGFR, 
                  results_timecourse4A1_10xEGFR, 
                  results_timecourse4A1_20xEGFR, 
                  results_timecourse4A1_40xEGFR, 
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_A1_Grob <- arrangeGrob(grobs = Fig4_A1)
ggsave(filename = "Fig4A1.png", plot = Fig4_A1_Grob)

ggsave(filename = "4A1_factor100.png", plot = Fig4_A1[["duration_factor100"]])
```
Only a marginal effect in [pERK] can be observed upon different initial values for fEGFR.  
  
Fig. 4B1 (free EGFR)
```{r}
# Load models
model_1xEGFR_free <- loadModel("1xEGFR_free.xml")
model_10xEGFR_free <- loadModel("10xEGFR_free.xml")
model_20xEGFR_free <- loadModel("20xEGFR_free.xml")
model_40xEGFR_free <- loadModel("40xEGFR_free.xml") 

# Time course
timecourse_4B1_1xEGFR <- c()
timecourse_4B1_1xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_1xEGFR_free)
timecourse_4B1_1xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_1xEGFR_free)
timecourse_4B1_1xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_1xEGFR_free)
timecourse_4B1_1xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_1xEGFR_free)
timecourse_4B1_10xEGFR <- c()
timecourse_4B1_10xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_10xEGFR_free)
timecourse_4B1_10xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_10xEGFR_free)
timecourse_4B1_10xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_10xEGFR_free)
timecourse_4B1_10xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_10xEGFR_free)
timecourse_4B1_20xEGFR <- c()
timecourse_4B1_20xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_20xEGFR_free)
timecourse_4B1_20xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_20xEGFR_free)
timecourse_4B1_20xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_20xEGFR_free)
timecourse_4B1_20xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_20xEGFR_free)
timecourse_4B1_40xEGFR <- c()
timecourse_4B1_40xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_40xEGFR_free)
timecourse_4B1_40xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_40xEGFR_free)
timecourse_4B1_40xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_40xEGFR_free)
timecourse_4B1_40xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_40xEGFR_free)

# Results of timecourse
results_timecourse4B1_1xEGFR <- lapply(timecourse_4B1_1xEGFR, function(x) as.data.frame(x$result))
results_timecourse4B1_10xEGFR <- lapply(timecourse_4B1_10xEGFR, function(x) as.data.frame(x$result))
results_timecourse4B1_20xEGFR <- lapply(timecourse_4B1_20xEGFR, function(x) as.data.frame(x$result))
results_timecourse4B1_40xEGFR <- lapply(timecourse_4B1_40xEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z,w){
  ggplot(data=x, aes(Time, pAkt))+
  geom_line(aes(col='1xEGFR'))+ 
    geom_line(data=y, aes(Time, pAkt, col='10xEGFR'))+ 
    geom_line(data=z, aes(Time, pAkt, col='20xEGFR'))+
    geom_line(data=w, aes(Time, pAkt, col='40xEGFR'))+
  scale_color_manual(name='Fold change in free EGFR',
                     breaks=c('1xEGFR', '10xEGFR', '20xEGFR', '40xEGFR'),
                     values=c('1xEGFR'='black', '10xEGFR'='green', '20xEGFR'='red', '40xEGFR' = 'brown'))
}

Fig4_B1 <- mapply(funct, 
                  results_timecourse4B1_1xEGFR, 
                  results_timecourse4B1_10xEGFR, 
                  results_timecourse4B1_20xEGFR, 
                  results_timecourse4B1_40xEGFR, 
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_B1_Grob <- arrangeGrob(grobs = Fig4_B1)
ggsave(filename = "Fig4B1.png", plot = Fig4_B1_Grob)

ggsave(filename = "4B1_factor100.png", plot = Fig4_B1[["duration_factor100"]])
```
A small effect in [pAkt] can be observed upon different initial values for fEGFR.  
  
Fig. 4C1 (free EGFR)
```{r}
# load models
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')
model_1xEGFR_free <- loadModel("1xEGFR_free.xml")
model_10xEGFR_free <- loadModel("10xEGFR_free.xml")
model_20xEGFR_free <- loadModel("20xEGFR_free.xml")
model_40xEGFR_free <- loadModel("40xEGFR_free.xml") 

# Time course
timecourse_4C1_1xEGFR <- c()
timecourse_4C1_1xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_1xEGFR_free)
timecourse_4C1_1xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_1xEGFR_free)
timecourse_4C1_1xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_1xEGFR_free)
timecourse_4C1_1xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_1xEGFR_free)
timecourse_4C1_10xEGFR <- c()
timecourse_4C1_10xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_10xEGFR_free)
timecourse_4C1_10xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_10xEGFR_free)
timecourse_4C1_10xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_10xEGFR_free)
timecourse_4C1_10xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_10xEGFR_free)
timecourse_4C1_20xEGFR <- c()
timecourse_4C1_20xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_20xEGFR_free)
timecourse_4C1_20xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_20xEGFR_free)
timecourse_4C1_20xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_20xEGFR_free)
timecourse_4C1_20xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_20xEGFR_free)
timecourse_4C1_40xEGFR <- c()
timecourse_4C1_40xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_40xEGFR_free)
timecourse_4C1_40xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_40xEGFR_free)
timecourse_4C1_40xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_40xEGFR_free)
timecourse_4C1_40xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_40xEGFR_free)
timecourse_4C1_W1 <- c()
timecourse_4C1_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_4C1_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_4C1_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_4C1_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)

# Results of timecourse
results_timecourse4C1_1xEGFR <- lapply(timecourse_4C1_1xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C1_10xEGFR <- lapply(timecourse_4C1_10xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C1_20xEGFR <- lapply(timecourse_4C1_20xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C1_40xEGFR <- lapply(timecourse_4C1_40xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C1_W1 <- lapply(timecourse_4C1_W1, function(x) as.data.frame(x$result))


# Plot
funct <- function(x,y,z,w,u){
  ggplot(data=x, aes(Time, bCatenin_TCF))+
  geom_line(aes(col='1xEGFR'))+ 
    geom_line(data=y, aes(Time, bCatenin_TCF, col='10xEGFR'))+ 
    geom_line(data=z, aes(Time, bCatenin_TCF, col='20xEGFR'))+
    geom_line(data=w, aes(Time, bCatenin_TCF, col='40xEGFR'))+
    geom_line(data=u, aes(Time, bCatenin_TCF, col='W=1'))+
  scale_color_manual(name='Fold change in free EGFR',
                     breaks=c('1xEGFR', '10xEGFR', '20xEGFR', '40xEGFR', 'W=1'),
                     values=c('1xEGFR'='black', '10xEGFR'='green', '20xEGFR'='red', '40xEGFR' = 'brown', 'W=1'='blue'))
}

Fig4_C1 <- mapply(funct, 
                  results_timecourse4C1_1xEGFR, 
                  results_timecourse4C1_10xEGFR, 
                  results_timecourse4C1_20xEGFR, 
                  results_timecourse4C1_40xEGFR,
                  results_timecourse4C1_W1,
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_C1_Grob <- arrangeGrob(grobs = Fig4_C1)
ggsave(filename = "Fig4C1.png", plot = Fig4_C1_Grob)

ggsave(filename = "4C1_factor100.png", plot = Fig4_C1[["duration_factor100"]])
```
  
Fig. 4A2 (bound EGFR)
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# 1 fold EGFR
setSpecies(key = "boundEGFR", compartment = "Cell", initial_concentration = 300, model = normal_model)
saveModel(filename = "1xEGFR_bound.xml",overwrite = TRUE, model = normal_model)
model_1xEGFR_bound <- loadModel("1xEGFR_bound.xml")

# 10 fold EGFR
setSpecies(key = "boundEGFR", compartment = "Cell", initial_concentration = 3000, model = normal_model)
saveModel(filename = "10xEGFR_bound.xml",overwrite = TRUE, model = normal_model)
model_10xEGFR_bound <- loadModel("10xEGFR_bound.xml")

# 20 fold EGFR
setSpecies(key = "boundEGFR", compartment = "Cell", initial_concentration = 6000, model = normal_model)
saveModel(filename = "20xEGFR_bound.xml",overwrite = TRUE, model = normal_model)
model_20xEGFR_bound <- loadModel("20xEGFR_bound.xml")

# 40 fold EGFR
setSpecies(key = "boundEGFR", compartment = "Cell", initial_concentration = 12000, model = normal_model)
saveModel(filename = "40xEGFR_bound.xml",overwrite = TRUE, model = normal_model)
model_40xEGFR_bound <- loadModel("40xEGFR_bound.xml") 


# Time course
timecourse_4A2_1xEGFR <- c()
timecourse_4A2_1xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4A2_1xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4A2_1xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4A2_1xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_1xEGFR_bound)
timecourse_4A2_10xEGFR <- c()
timecourse_4A2_10xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4A2_10xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4A2_10xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4A2_10xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_10xEGFR_bound)
timecourse_4A2_20xEGFR <- c()
timecourse_4A2_20xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4A2_20xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4A2_20xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4A2_20xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_20xEGFR_bound)
timecourse_4A2_40xEGFR <- c()
timecourse_4A2_40xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4A2_40xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4A2_40xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4A2_40xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_40xEGFR_bound)

# Results of timecourse
results_timecourse4A2_1xEGFR <- lapply(timecourse_4A2_1xEGFR, function(x) as.data.frame(x$result))
results_timecourse4A2_10xEGFR <- lapply(timecourse_4A2_10xEGFR, function(x) as.data.frame(x$result))
results_timecourse4A2_20xEGFR <- lapply(timecourse_4A2_20xEGFR, function(x) as.data.frame(x$result))
results_timecourse4A2_40xEGFR <- lapply(timecourse_4A2_40xEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z,w){
  ggplot(data=x, aes(Time, pERK))+
  geom_line(aes(col='1xEGFR'))+ 
    geom_line(data=y, aes(Time, pERK, col='10xEGFR'))+ 
    geom_line(data=z, aes(Time, pERK, col='20xEGFR'))+
    geom_line(data=w, aes(Time, pERK, col='40xEGFR'))+
  scale_color_manual(name='Fold change in bound EGFR',
                     breaks=c('1xEGFR', '10xEGFR', '20xEGFR', '40xEGFR'),
                     values=c('1xEGFR'='black', '10xEGFR'='green', '20xEGFR'='red', '40xEGFR' = 'brown'))
}

Fig4_A2 <- mapply(funct, 
                  results_timecourse4A2_1xEGFR, 
                  results_timecourse4A2_10xEGFR, 
                  results_timecourse4A2_20xEGFR, 
                  results_timecourse4A2_40xEGFR, 
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_A2_Grob <- arrangeGrob(grobs = Fig4_A2)
ggsave(filename = "Fig4A2.png", plot = Fig4_A2_Grob)

ggsave(filename = "4A2_factor100.png", plot = Fig4_A2[["duration_factor100"]])
```
  
Fig. 4B2 (bound EGFR)
```{r}
# Load models
model_1xEGFR_bound <- loadModel("1xEGFR_bound.xml")
model_10xEGFR_bound <- loadModel("10xEGFR_bound.xml")
model_20xEGFR_bound <- loadModel("20xEGFR_bound.xml")
model_40xEGFR_bound <- loadModel("40xEGFR_bound.xml") 

# Time course
timecourse_4B2_1xEGFR <- c()
timecourse_4B2_1xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4B2_1xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4B2_1xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4B2_1xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_1xEGFR_bound)
timecourse_4B2_10xEGFR <- c()
timecourse_4B2_10xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4B2_10xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4B2_10xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4B2_10xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_10xEGFR_bound)
timecourse_4B2_20xEGFR <- c()
timecourse_4B2_20xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4B2_20xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4B2_20xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4B2_20xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_20xEGFR_bound)
timecourse_4B2_40xEGFR <- c()
timecourse_4B2_40xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4B2_40xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4B2_40xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4B2_40xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_40xEGFR_bound)

# Results of timecourse
results_timecourse4B2_1xEGFR <- lapply(timecourse_4B2_1xEGFR, function(x) as.data.frame(x$result))
results_timecourse4B2_10xEGFR <- lapply(timecourse_4B2_10xEGFR, function(x) as.data.frame(x$result))
results_timecourse4B2_20xEGFR <- lapply(timecourse_4B2_20xEGFR, function(x) as.data.frame(x$result))
results_timecourse4B2_40xEGFR <- lapply(timecourse_4B2_40xEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z,w){
  ggplot(data=x, aes(Time, pAkt))+
  geom_line(aes(col='1xEGFR'))+ 
    geom_line(data=y, aes(Time, pAkt, col='10xEGFR'))+ 
    geom_line(data=z, aes(Time, pAkt, col='20xEGFR'))+
    geom_line(data=w, aes(Time, pAkt, col='40xEGFR'))+
  scale_color_manual(name='Fold change in bound EGFR',
                     breaks=c('1xEGFR', '10xEGFR', '20xEGFR', '40xEGFR'),
                     values=c('1xEGFR'='black', '10xEGFR'='green', '20xEGFR'='red', '40xEGFR' = 'brown'))
}

Fig4_B2 <- mapply(funct, 
                  results_timecourse4B2_1xEGFR, 
                  results_timecourse4B2_10xEGFR, 
                  results_timecourse4B2_20xEGFR, 
                  results_timecourse4B2_40xEGFR, 
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_B2_Grob <- arrangeGrob(grobs = Fig4_B2)
ggsave(filename = "Fig4B2.png", plot = Fig4_B2_Grob)

ggsave(filename = "4B2_factor100.png", plot = Fig4_B2[["duration_factor100"]])
```
  
Fig. 4C2 (bound EGFR)
```{r}
# load models
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')
model_1xEGFR_bound <- loadModel("1xEGFR_bound.xml")
model_10xEGFR_bound <- loadModel("10xEGFR_bound.xml")
model_20xEGFR_bound <- loadModel("20xEGFR_bound.xml")
model_40xEGFR_bound <- loadModel("40xEGFR_bound.xml")

# Time course
timecourse_4C2_1xEGFR <- c()
timecourse_4C2_1xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4C2_1xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4C2_1xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_1xEGFR_bound)
timecourse_4C2_1xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_1xEGFR_bound)
timecourse_4C2_10xEGFR <- c()
timecourse_4C2_10xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4C2_10xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4C2_10xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_10xEGFR_bound)
timecourse_4C2_10xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_10xEGFR_bound)
timecourse_4C2_20xEGFR <- c()
timecourse_4C2_20xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4C2_20xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4C2_20xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_20xEGFR_bound)
timecourse_4C2_20xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_20xEGFR_bound)
timecourse_4C2_40xEGFR <- c()
timecourse_4C2_40xEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4C2_40xEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4C2_40xEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_40xEGFR_bound)
timecourse_4C2_40xEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_40xEGFR_bound)
timecourse_4C2_W1 <- c()
timecourse_4C2_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_4C2_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_4C2_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_4C2_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)

# Results of timecourse
results_timecourse4C2_1xEGFR <- lapply(timecourse_4C2_1xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C2_10xEGFR <- lapply(timecourse_4C2_10xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C2_20xEGFR <- lapply(timecourse_4C2_20xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C2_40xEGFR <- lapply(timecourse_4C2_40xEGFR, function(x) as.data.frame(x$result))
results_timecourse4C2_W1 <- lapply(timecourse_4C2_W1, function(x) as.data.frame(x$result))


# Plot
funct <- function(x,y,z,w,u){
  ggplot(data=x, aes(Time, bCatenin_TCF))+
  geom_line(aes(col='1xEGFR'))+ 
    geom_line(data=y, aes(Time, bCatenin_TCF, col='10xEGFR'))+ 
    geom_line(data=z, aes(Time, bCatenin_TCF, col='20xEGFR'))+
    geom_line(data=w, aes(Time, bCatenin_TCF, col='40xEGFR'))+
    geom_line(data=u, aes(Time, bCatenin_TCF, col='W=1'))+
  scale_color_manual(name='Fold change in bound EGFR',
                     breaks=c('1xEGFR', '10xEGFR', '20xEGFR', '40xEGFR', 'W=1'),
                     values=c('1xEGFR'='black', '10xEGFR'='green', '20xEGFR'='red', '40xEGFR' = 'brown', 'W=1'='blue'))
}

Fig4_C2 <- mapply(funct, 
                  results_timecourse4C2_1xEGFR, 
                  results_timecourse4C2_10xEGFR, 
                  results_timecourse4C2_20xEGFR, 
                  results_timecourse4C2_40xEGFR,
                  results_timecourse4C2_W1,
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_C2_Grob <- arrangeGrob(grobs = Fig4_C2)
ggsave(filename = "Fig4C2.png", plot = Fig4_C2_Grob)

ggsave(filename = "4C2_factor100.png", plot = Fig4_C2[["duration_factor100"]])
```

Fig. 4D
```{r}
# load normal model
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# Set time course
timecourse_4D <- c()
timecourse_4D$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_4D$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_4D$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_4D$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# Remove the EGFR degradation reactions and global quantities
deleteReaction(key = "EGF degradation", model = normal_model)
# Save sustained EGFR mutated model (no EGFR degradation)
saveModel(filename = "sustainedEGFR_JR.xml",overwrite = TRUE, model = normal_model)
model_sustainedEGFR <- loadModel("sustainedEGFR_JR.xml")

# Run time course for edited model
timecourse_4D_sustainedEGFR <- c()
timecourse_4D_sustainedEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_sustainedEGFR)
timecourse_4D_sustainedEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_sustainedEGFR)
timecourse_4D_sustainedEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_sustainedEGFR)
timecourse_4D_sustainedEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_sustainedEGFR)

# retrieve results from different timecourse settings
results_timecourse4D <- lapply(timecourse_4D, function(x) as.data.frame(x$result))
results_timecourse4D_sustainedEGFR <- lapply(timecourse_4D_sustainedEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, pERK))+
  geom_line(aes(col='normal'))+ 
    geom_line(data=y, aes(Time, pERK, col='mutated'))+ 
  scale_color_manual(name='EGFR w/wo degradation',
                     breaks=c('normal', 'mutated'),
                     values=c('mutated'='red', 'normal'='black'))
}

Fig4_D <- mapply(funct, 
                  results_timecourse4D, 
                  results_timecourse4D_sustainedEGFR,
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_D_Grob <- arrangeGrob(grobs = Fig4_D)
ggsave(filename = "Fig4D.png", plot = Fig4_D_Grob)

ggsave(filename = "4D_factor10.png", plot = Fig4_D[["duration_factor10"]])
```
  
Fig. 4E
```{r}
# load original models to make sure that the settings are not changed
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
sustainedEGFR_model <- loadModel('sustainedEGFR_JR.xml')

# Set time course
timecourse_4E <- c()
timecourse_4E$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_4E$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_4E$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_4E$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_4E_sustainedEGFR <- c()
timecourse_4E_sustainedEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_sustainedEGFR)
timecourse_4E_sustainedEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_sustainedEGFR)
timecourse_4E_sustainedEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_sustainedEGFR)
timecourse_4E_sustainedEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_sustainedEGFR)

# retrieve results from different timecourse settings
results_timecourse4E <- lapply(timecourse_4E, function(x) as.data.frame(x$result))
results_timecourse4E_sustainedEGFR <- lapply(timecourse_4E_sustainedEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, pAkt))+
  geom_line(aes(col='normal'))+ 
    geom_line(data=y, aes(Time, pAkt, col='mutated'))+ 
  scale_color_manual(name='EGFR w/wo degradation',
                     breaks=c('normal', 'mutated'),
                     values=c('mutated'='red', 'normal'='black'))
}

Fig4_E <- mapply(funct, 
                  results_timecourse4E, 
                  results_timecourse4E_sustainedEGFR,
                  USE.NAMES = T, 
                  SIMPLIFY = F)

Fig4_E_Grob <- arrangeGrob(grobs = Fig4_E)
ggsave(filename = "Fig4E.png", plot = Fig4_E_Grob)

ggsave(filename = "4E_factor10.png", plot = Fig4_E[["duration_factor10"]])
```
  
Fig. 4F
```{r}
# load original models to make sure that the settings are not changed
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
sustainedEGFR_model <- loadModel('sustainedEGFR_JR.xml')
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')

# Set time course
timecourse_4F <- c()
timecourse_4F$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_4F$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_4F$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_4F$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_4F_W1 <- c()
timecourse_4F_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_4F_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_4F_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_4F_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)
timecourse_4F_sustainedEGFR <- c()
timecourse_4F_sustainedEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = sustainedEGFR_model)
timecourse_4F_sustainedEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = sustainedEGFR_model)
timecourse_4F_sustainedEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = sustainedEGFR_model)
timecourse_4F_sustainedEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = sustainedEGFR_model)

# retrieve results from different timecourse settings
results_timecourse4F <- lapply(timecourse_4F, function(x) as.data.frame(x$result))
results_timecourse4F_W1 <- lapply(timecourse_4F_W1, function(x) as.data.frame(x$result))
results_timecourse4F_sustainedEGFR <- lapply(timecourse_4F_sustainedEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z){
  ggplot(data=x, aes(Time, bCatenin_TCF))+geom_line(aes(col='mutated (W=0)'))+ 
    geom_line(data=y, aes(Time, bCatenin_TCF, col='normal (W=0)'))+ 
    geom_line(data=z, aes(Time, bCatenin_TCF, col='normal (W=1)'))+
    scale_color_manual(name='EGFR w/wo degradation',
                       breaks=c('normal (W=0)', 'mutated (W=0)', 'normal (W=1)'),
                       values=c('mutated (W=0)'='red', 'normal (W=0)'='black', 'normal (W=1)'='blue'))
}

Fig4_F <- mapply(funct, results_timecourse4F_sustainedEGFR, results_timecourse4F, results_timecourse4F_W1, USE.NAMES = T, SIMPLIFY = F)

Fig4_F_Grob <- arrangeGrob(grobs = Fig4_F)
ggsave(filename = "Fig4F.png", plot = Fig4_F_Grob)

ggsave(filename = "4F_factor100.png", plot = Fig4_F[["duration_factor100"]])
```
  
Fig. 4G  
**Output differs slightly from Figure 4G in paper**
```{r}
# load original models to make sure that the settings are not changed
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
sustainedEGFR_model <- loadModel('sustainedEGFR_JR.xml')

# Run time course for edited model
timecourse_4G <- c()
timecourse_4G$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_4G$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_4G$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_4G$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_4G_sustainedEGFR <- c()
timecourse_4G_sustainedEGFR$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = sustainedEGFR_model)
timecourse_4G_sustainedEGFR$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = sustainedEGFR_model)
timecourse_4G_sustainedEGFR$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = sustainedEGFR_model)
timecourse_4G_sustainedEGFR$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = sustainedEGFR_model)

# retrieve results from different timecourse settings
results_timecourse4G <- lapply(timecourse_4G, function(x) as.data.frame(x$result))
results_timecourse4G_sustainedEGFR <- lapply(timecourse_4G_sustainedEGFR, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(data=x, aes(Time, GSK3b))+geom_line(aes(col='mutated'))+ 
    geom_line(data=y, aes(Time, GSK3b, col='normal'))+ 
    scale_color_manual(name='EGFR w/wo degradation',
                       breaks=c('normal', 'mutated'),
                       values=c('mutated'='red', 'normal'='black'))
}

Fig4_G <- mapply(funct, results_timecourse4G_sustainedEGFR, results_timecourse4G, USE.NAMES = T, SIMPLIFY = F)

Fig4_G_Grob <- arrangeGrob(grobs = Fig4_G)
ggsave(filename = "Fig4G.png", plot = Fig4_G_Grob)

ggsave(filename = "4G_factor10.png", plot = Fig4_G[["duration_factor10"]])
```
  
## Recapitulate Figure 5 plots (Increased Kcat of PI3K (5A,B) / Mutated PI3K (5C,D) / Mutated PTEN (5E,G)  
Fig. 5A
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')

# 1 fold Kcat of PI3K
setGlobalQuantities(key = "Kcat20", initial_value = 4, model = normal_model)
saveModel(filename = "PI3K_Kcat4.xml",overwrite = TRUE, model = normal_model)
model_Kcat4 <- loadModel("PI3K_Kcat4.xml")
# 2.5 fold Kcat of PI3K
setGlobalQuantities(key = "Kcat20", initial_value = 10, model = normal_model)
saveModel(filename = "PI3K_Kcat10.xml",overwrite = TRUE, model = normal_model)
model_Kcat10 <- loadModel("PI3K_Kcat10.xml")
# 5 fold Kcat of PI3K
setGlobalQuantities(key = "Kcat20", initial_value = 20, model = normal_model)
saveModel(filename = "PI3K_Kcat20.xml",overwrite = TRUE, model = normal_model)
model_Kcat20 <- loadModel("PI3K_Kcat20.xml")
# 10 fold Kcat of PI3K
setGlobalQuantities(key = "Kcat20", initial_value = 40, model = normal_model)
saveModel(filename = "PI3K_Kcat40.xml",overwrite = TRUE, model = normal_model)
model_Kcat40 <- loadModel("PI3K_Kcat40.xml")

# Time course
timecourse_5A_Kcat4 <- c()
timecourse_5A_Kcat4$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat4)
timecourse_5A_Kcat4$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat4)
timecourse_5A_Kcat4$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat4)
timecourse_5A_Kcat4$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat4)
timecourse_5A_Kcat10 <- c()
timecourse_5A_Kcat10$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat10)
timecourse_5A_Kcat10$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat10)
timecourse_5A_Kcat10$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat10)
timecourse_5A_Kcat10$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat10)
timecourse_5A_Kcat20 <- c()
timecourse_5A_Kcat20$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat20)
timecourse_5A_Kcat20$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat20)
timecourse_5A_Kcat20$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat20)
timecourse_5A_Kcat20$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat20)
timecourse_5A_Kcat40 <- c()
timecourse_5A_Kcat40$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat40)
timecourse_5A_Kcat40$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat40)
timecourse_5A_Kcat40$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat40)
timecourse_5A_Kcat40$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat40)

# Results
results_timecourse5A_Kcat4 <- lapply(timecourse_5A_Kcat4, function(x) as.data.frame(x$result))
results_timecourse5A_Kcat10 <- lapply(timecourse_5A_Kcat10, function(x) as.data.frame(x$result))
results_timecourse5A_Kcat20 <- lapply(timecourse_5A_Kcat20, function(x) as.data.frame(x$result))
results_timecourse5A_Kcat40 <- lapply(timecourse_5A_Kcat40, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z,u){
  ggplot(x, aes(x = Time, y = pAkt))+
  geom_line(aes(col = 'normal PI3K act.'))+
  geom_line(data = y, aes(x = Time, y = pAkt, col = '2.5 fold Kcat of PI3K act.'))+
  geom_line(data = z, aes(x = Time, y = pAkt, col = '5 fold Kcat of PI3K act.'))+
  geom_line(data = u, aes(x = Time, y = pAkt, col = '10 fold Kcat of PI3K act.'))+
  scale_color_manual(name='Kcat of PI3K',
                     breaks=c('normal PI3K act.', 
                              '2.5 fold Kcat of PI3K act.', 
                              '5 fold Kcat of PI3K act.', 
                              '10 fold Kcat of PI3K act.'),
                     values=c('normal PI3K act.'='brown', 
                              '2.5 fold Kcat of PI3K act.'='red',
                              '5 fold Kcat of PI3K act.'='green',
                              '10 fold Kcat of PI3K act.'='black'))
}

Fig5_A <- mapply(funct, 
                 results_timecourse5A_Kcat4, 
                 results_timecourse5A_Kcat10,
                 results_timecourse5A_Kcat20,
                 results_timecourse5A_Kcat40,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_A_Grob <- arrangeGrob(grobs = Fig5_A)
ggsave(filename = "Fig5A.png", plot = Fig5_A_Grob)

ggsave(filename = "5A_factor10.png", plot = Fig5_A[["duration_factor10"]])
```
  
Fig. 5B
```{r}
# Load models
model_Kcat4  <- loadModel("PI3K_Kcat4.xml")
model_Kcat10 <- loadModel("PI3K_Kcat10.xml")
model_Kcat20 <- loadModel("PI3K_Kcat20.xml")
model_Kcat40 <- loadModel("PI3K_Kcat40.xml")

# Time course
timecourse_5B_Kcat4 <- c()
timecourse_5B_Kcat4$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat4)
timecourse_5B_Kcat4$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat4)
timecourse_5B_Kcat4$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat4)
timecourse_5B_Kcat4$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat4)
timecourse_5B_Kcat10 <- c()
timecourse_5B_Kcat10$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat10)
timecourse_5B_Kcat10$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat10)
timecourse_5B_Kcat10$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat10)
timecourse_5B_Kcat10$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat10)
timecourse_5B_Kcat20 <- c()
timecourse_5B_Kcat20$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat20)
timecourse_5B_Kcat20$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat20)
timecourse_5B_Kcat20$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat20)
timecourse_5B_Kcat20$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat20)
timecourse_5B_Kcat40 <- c()
timecourse_5B_Kcat40$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, 
                                     model = model_Kcat40)
timecourse_5B_Kcat40$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, 
                                     model = model_Kcat40)
timecourse_5B_Kcat40$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, 
                                     model = model_Kcat40)
timecourse_5B_Kcat40$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, 
                                     model = model_Kcat40)

# Results
results_timecourse5B_Kcat4 <- lapply(timecourse_5B_Kcat4, function(x) as.data.frame(x$result))
results_timecourse5B_Kcat10 <- lapply(timecourse_5B_Kcat10, function(x) as.data.frame(x$result))
results_timecourse5B_Kcat20 <- lapply(timecourse_5B_Kcat20, function(x) as.data.frame(x$result))
results_timecourse5B_Kcat40 <- lapply(timecourse_5B_Kcat40, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z,u){
  ggplot(x, aes(x = Time, y = PIP3))+
  geom_line(aes(col = 'normal PI3K act.'))+
  geom_line(data = y, aes(x = Time, y = PIP3, col = '2.5 fold Kcat of PI3K act.'))+
  geom_line(data = z, aes(x = Time, y = PIP3, col = '5 fold Kcat of PI3K act.'))+
  geom_line(data = u, aes(x = Time, y = PIP3, col = '10 fold Kcat of PI3K act.'))+
  scale_color_manual(name='Kcat of PI3K',
                     breaks=c('normal PI3K act.', 
                              '2.5 fold Kcat of PI3K act.', 
                              '5 fold Kcat of PI3K act.', 
                              '10 fold Kcat of PI3K act.'),
                     values=c('normal PI3K act.'='brown', 
                              '2.5 fold Kcat of PI3K act.'='red',
                              '5 fold Kcat of PI3K act.'='green',
                              '10 fold Kcat of PI3K act.'='black'))
}

Fig5_B <- mapply(funct, 
                 results_timecourse5B_Kcat4, 
                 results_timecourse5B_Kcat10,
                 results_timecourse5B_Kcat20,
                 results_timecourse5B_Kcat40,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_B_Grob <- arrangeGrob(grobs = Fig5_B)
ggsave(filename = "Fig5B.png", plot = Fig5_B_Grob)

ggsave(filename = "5B_factor10.png", plot = Fig5_B[["duration_factor10"]])
```
  
5C
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
# Run timecourse
timecourse_5C <- c()
timecourse_5C$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_5C$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_5C$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_5C$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# Remove function for dephosphorylation of PI3K
deleteGlobalQuantity(key = "k19c", model = normal_model)
saveModel(filename = "PI3K_JR.xml",overwrite = TRUE, model = normal_model)
model_PI3K <- loadModel("PI3K_JR.xml")
# Run timecourse
timecourse_5C_PI3K <- c()
timecourse_5C_PI3K$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_PI3K)
timecourse_5C_PI3K$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_PI3K)
timecourse_5C_PI3K$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_PI3K)
timecourse_5C_PI3K$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_PI3K)

# Results
results_timecourse5C <- lapply(timecourse_5C, function(x) as.data.frame(x$result))
results_timecourse5C_PI3K <- lapply(timecourse_5C_PI3K, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = pAkt))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = pAkt, col = 'mutated PI3K'))+
  scale_color_manual(name='PI3K',
                     breaks=c('normal', 
                              'mutated PI3K'),
                     values=c('normal'='black', 
                              'mutated PI3K'='red'))
}

Fig5_C <- mapply(funct, 
                 results_timecourse5C, 
                 results_timecourse5C_PI3K,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_C_Grob <- arrangeGrob(grobs = Fig5_C)
ggsave(filename = "Fig5C.png", plot = Fig5_C_Grob)

ggsave(filename = "5C_factor10.png", plot = Fig5_C[["duration_factor10"]])
```
5D
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
model_PI3K <- loadModel('PI3K_JR.xml')

# Run timecourse
timecourse_5D <- c()
timecourse_5D$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_5D$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_5D$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_5D$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# Run timecourse
timecourse_5D_PI3K <- c()
timecourse_5D_PI3K$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_PI3K)
timecourse_5D_PI3K$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_PI3K)
timecourse_5D_PI3K$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_PI3K)
timecourse_5D_PI3K$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_PI3K)

# Results
results_timecourse5D <- lapply(timecourse_5D, function(x) as.data.frame(x$result))
results_timecourse5D_PI3K <- lapply(timecourse_5D_PI3K, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = PIP3))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = PIP3, col = 'mutated PI3K'))+
  scale_color_manual(name='PI3K',
                     breaks=c('normal', 
                              'mutated PI3K'),
                     values=c('normal'='black', 
                              'mutated PI3K'='red'))
}

Fig5_D <- mapply(funct, 
                 results_timecourse5D, 
                 results_timecourse5D_PI3K,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_D_Grob <- arrangeGrob(grobs = Fig5_D)
ggsave(filename = "Fig5D.png", plot = Fig5_D_Grob)

ggsave(filename = "5D_factor10.png", plot = Fig5_D[["duration_factor10"]])
```
  
5E
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
# Run timecourse
timecourse_5E <- c()
timecourse_5E$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_5E$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_5E$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_5E$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# Remove PTEN from species
deleteSpecies(key = "PTEN", model = normal_model)
saveModel(filename = "PTEN_JR.xml",overwrite = TRUE, model = normal_model)
model_PTEN <- loadModel("PTEN_JR.xml")
# Run timecourse
timecourse_5E_PTEN <- c()
timecourse_5E_PTEN$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_PTEN)
timecourse_5E_PTEN$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_PTEN)
timecourse_5E_PTEN$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_PTEN)
timecourse_5E_PTEN$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_PTEN)

# Results
results_timecourse5E <- lapply(timecourse_5E, function(x) as.data.frame(x$result))
results_timecourse5E_PTEN <- lapply(timecourse_5E_PTEN, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = pAkt))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = pAkt, col = 'mutated PTEN'))+
  scale_color_manual(name='PTEN',
                     breaks=c('normal', 
                              'mutated PTEN'),
                     values=c('normal'='black', 
                              'mutated PTEN'='red'))
}

Fig5_E <- mapply(funct, 
                 results_timecourse5E, 
                 results_timecourse5E_PTEN,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_E_Grob <- arrangeGrob(grobs = Fig5_E)
ggsave(filename = "Fig5E.png", plot = Fig5_E_Grob)

ggsave(filename = "5E_factor10.png", plot = Fig5_E[["duration_factor10"]])
```
  
5F
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
model_PTEN <- loadModel("PTEN_JR.xml")

# Run timecourse
timecourse_5F <- c()
timecourse_5F$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_5F$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_5F$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_5F$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_5F_PTEN <- c()
timecourse_5F_PTEN$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_PTEN)
timecourse_5F_PTEN$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_PTEN)
timecourse_5F_PTEN$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_PTEN)
timecourse_5F_PTEN$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_PTEN)

# Results
results_timecourse5F <- lapply(timecourse_5F, function(x) as.data.frame(x$result))
results_timecourse5F_PTEN <- lapply(timecourse_5F_PTEN, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = pERK))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = pERK, col = 'mutated PTEN'))+
  scale_color_manual(name='PTEN',
                     breaks=c('normal', 
                              'mutated PTEN'),
                     values=c('normal'='black', 
                              'mutated PTEN'='red'))
}

Fig5_F <- mapply(funct, 
                 results_timecourse5F, 
                 results_timecourse5F_PTEN,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_F_Grob <- arrangeGrob(grobs = Fig5_F)
ggsave(filename = "Fig5F.png", plot = Fig5_F_Grob)

ggsave(filename = "5F_factor10.png", plot = Fig5_F[["duration_factor10"]])
```
  
5G
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
model_PTEN <- loadModel("PTEN_JR.xml")
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')


# Run timecourse
timecourse_5G <- c()
timecourse_5G$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_5G$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_5G$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_5G$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_5G_PTEN <- c()
timecourse_5G_PTEN$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_PTEN)
timecourse_5G_PTEN$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_PTEN)
timecourse_5G_PTEN$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_PTEN)
timecourse_5G_PTEN$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_PTEN)
timecourse_5G_W1 <- c()
timecourse_5G_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_5G_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_5G_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_5G_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)

# Results
results_timecourse5G <- lapply(timecourse_5G, function(x) as.data.frame(x$result))
results_timecourse5G_PTEN <- lapply(timecourse_5G_PTEN, function(x) as.data.frame(x$result))
results_timecourse5G_W1 <- lapply(timecourse_5G_W1, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z){
  ggplot(x, aes(x = Time, y = bCatenin_TCF))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = bCatenin_TCF, col = 'mutated PTEN'))+
  geom_line(data = z, aes(x = Time, y = bCatenin_TCF, col = 'W=1'))+
  scale_color_manual(name='PTEN',
                     breaks=c('normal', 
                              'mutated PTEN',
                              'W=1'),
                     values=c('normal'='black', 
                              'mutated PTEN'='red',
                              'W=1'='blue'))
}

Fig5_G <- mapply(funct, 
                 results_timecourse5G, 
                 results_timecourse5G_PTEN,
                 results_timecourse5G_W1,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig5_G_Grob <- arrangeGrob(grobs = Fig5_G)
ggsave(filename = "Fig5G.png", plot = Fig5_G_Grob)

ggsave(filename = "5G_factor100.png", plot = Fig5_G[["duration_factor100"]])
```
  
## Recapitulate Figure 6 plots (Mutated Destruction Complex (DC))   
Fig. 6A
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
# Run timecourse
timecourse_6A <- c()
timecourse_6A$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_6A$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_6A$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_6A$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)

# Remove reactions associated with the formation of the DC
#deleteReaction(key = "APC_Axin_GSK3b complex formation", model = normal_model)
#deleteGlobalQuantity(key = c("k32a", "k32b"), model = normal_model)
#deleteSpecies(key = "pAPC_pAxin_GSK3b_pbCatenin", model = normal_model)
deleteGlobalQuantity(key = "k342", model = normal_model)
saveModel(filename = "DC_JR.xml",overwrite = TRUE, model = normal_model)
model_DC <- loadModel("DC_JR.xml")
# Run timecourse
timecourse_6A_DC <- c()
timecourse_6A_DC$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_DC)
timecourse_6A_DC$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_DC)
timecourse_6A_DC$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_DC)
timecourse_6A_DC$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_DC)

# Results
results_timecourse6A <- lapply(timecourse_6A, function(x) as.data.frame(x$result))
results_timecourse6A_DC <- lapply(timecourse_6A_DC, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = GSK3b))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = GSK3b, col = 'mutated DC'))+
  scale_color_manual(name='Destruction complex',
                     breaks=c('normal', 
                              'mutated DC'),
                     values=c('normal'='black', 
                              'mutated DC'='red'))
}

Fig6_A <- mapply(funct, 
                 results_timecourse6A, 
                 results_timecourse6A_DC,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig6_A_Grob <- arrangeGrob(grobs = Fig6_A)
ggsave(filename = "Fig6A.png", plot = Fig6_A_Grob)

ggsave(filename = "6A_factor10.png", plot = Fig6_A[["duration_factor10"]])
```
  
**Contrary to the paper Figure 6A, I don't observe a complete inactivation of GSK3b upon mutated DC. I observed similar results upon removal of reactions 32a and 32b which are associated with DC formation (Supplementary material). Even removal of a component (Axin) of the DC did not lead to similar results as shown in the paper. Why should it make sense to have different GSK3b levels if the DC can't form? Maybe different levels of pGSK3b? But there is also no change in [pGSK3b] upon deletion of DC formation reaction.**  
  
Fig. 6B
```{r}
# Load again the original model to make sure that the settings are back to normal
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
model_DC <- loadModel('DC_JR.xml')
normal_model_W1 <- loadModel('normal_model_W1_JR.xml')

# Run time course
timecourse_6B <- c()
timecourse_6B$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_6B$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_6B$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_6B$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_6B_DC <- c()
timecourse_6B_DC$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_DC)
timecourse_6B_DC$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_DC)
timecourse_6B_DC$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_DC)
timecourse_6B_DC$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_DC)
timecourse_6B_W1 <- c()
timecourse_6B_W1$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model_W1)
timecourse_6B_W1$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model_W1)
timecourse_6B_W1$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model_W1)
timecourse_6B_W1$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model_W1)

# Results
results_timecourse6B <- lapply(timecourse_6B, function(x) as.data.frame(x$result))
results_timecourse6B_DC <- lapply(timecourse_6B_DC, function(x) as.data.frame(x$result))
results_timecourse6B_W1 <- lapply(timecourse_6B_W1, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y,z){
  ggplot(x, aes(x = Time, y = bCatenin_TCF))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = bCatenin_TCF, col = 'mutated DC'))+
  geom_line(data = z, aes(x = Time, y = bCatenin_TCF, col = 'W=1'))+
  scale_color_manual(name='Destruction complex',
                     breaks=c('normal', 
                              'mutated DC',
                              'W=1'),
                     values=c('normal'='black', 
                              'mutated DC'='red',
                              'W=1'='blue'))
}

Fig6_B <- mapply(funct, 
                 results_timecourse6B, 
                 results_timecourse6B_DC,
                 results_timecourse6B_W1,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig6_B_Grob <- arrangeGrob(grobs = Fig6_B)
ggsave(filename = "Fig6B.png", plot = Fig6_B_Grob)

ggsave(filename = "6B_factor100.png", plot = Fig6_B[["duration_factor100"]])
```
  
**curve for mutated DC does not agree with Fig. 6B in paper**  
  
6C
```{r}
# Load again the original model
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
model_DC <- loadModel("DC_JR.xml")

# Run timecourse
timecourse_6C <- c()
timecourse_6C$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_6C$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_6C$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_6C$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_6C_DC <- c()
timecourse_6C_DC$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_DC)
timecourse_6C_DC$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_DC)
timecourse_6C_DC$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_DC)
timecourse_6C_DC$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_DC)

# Results
results_timecourse6C <- lapply(timecourse_6C, function(x) as.data.frame(x$result))
results_timecourse6C_DC <- lapply(timecourse_6C_DC, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = pERK))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = pERK, col = 'mutated DC'))+
  scale_color_manual(name='Destruction complex',
                     breaks=c('normal', 
                              'mutated DC'),
                     values=c('normal'='black', 
                              'mutated DC'='red'))
}

Fig6_C <- mapply(funct, 
                 results_timecourse6C, 
                 results_timecourse6C_DC,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig6_C_Grob <- arrangeGrob(grobs = Fig6_C)
ggsave(filename = "Fig6C.png", plot = Fig6_C_Grob)

ggsave(filename = "6C_factor100.png", plot = Fig6_C[["duration_factor100"]])
```  
6D
```{r}
# Load again the original model
normal_model <- loadSBML('BIOMD0000000648_V40_final.xml')
model_DC <- loadModel("DC_JR.xml")

# Run timecourse
timecourse_6D <- c()
timecourse_6D$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = normal_model)
timecourse_6D$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = normal_model)
timecourse_6D$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = normal_model)
timecourse_6D$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = normal_model)
timecourse_6D_DC <- c()
timecourse_6D_DC$duration_factor1 <- runTimeCourse(duration = 1e-7, intervals = 1000, model = model_DC)
timecourse_6D_DC$duration_factor10 <- runTimeCourse(duration = 1e-6, intervals = 1000, model = model_DC)
timecourse_6D_DC$duration_factor100 <- runTimeCourse(duration = 1e-5, intervals = 1000, model = model_DC)
timecourse_6D_DC$duration_factor1000 <- runTimeCourse(duration = 1e-4, intervals = 100, model = model_DC)

# Results
results_timecourse6D <- lapply(timecourse_6D, function(x) as.data.frame(x$result))
results_timecourse6D_DC <- lapply(timecourse_6D_DC, function(x) as.data.frame(x$result))

# Plot
funct <- function(x,y){
  ggplot(x, aes(x = Time, y = pRaf1))+
  geom_line(aes(col = 'normal'))+
  geom_line(data = y, aes(x = Time, y = pRaf1, col = 'mutated DC'))+
  scale_color_manual(name='Destruction complex',
                     breaks=c('normal', 
                              'mutated DC'),
                     values=c('normal'='black', 
                              'mutated DC'='red'))
}

Fig6_D <- mapply(funct, 
                 results_timecourse6D, 
                 results_timecourse6D_DC,
                 USE.NAMES = T,
                 SIMPLIFY = F)

Fig6_D_Grob <- arrangeGrob(grobs = Fig6_D)
ggsave(filename = "Fig6D.png", plot = Fig6_D_Grob)

ggsave(filename = "6D_factor100.png", plot = Fig6_D[["duration_factor100"]])
```  